<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="custom.css">
    <link rel="stylesheet" href="syntax.css">
    <base target="_blank">
  </html>
  <body>
      <h1 id="networking-cloud-computing-review">Networking: cloud computing; review</h1>
<p><em>COSC 208, Introduction to Computer Systems, 2021-12-10</em></p>

<h2 id="announcements">Announcements</h2>
<ul>
  <li>Office hours
    <ul>
      <li>Today 10:15am-11:45am</li>
      <li>Monday 12pm-4pm</li>
      <li>Wednesday 8:30am-10:30am</li>
      <li>Thursday 9:30am-11:30am</li>
    </ul>
  </li>
  <li>Final exam
    <ul>
      <li>Study guide posted on Moodle</li>
      <li>Take-home portion due Friday at 9am</li>
      <li>In-class portion Friday 9am-11am</li>
    </ul>
  </li>
</ul>

<h2 id="outline">Outline</h2>
<ul>
  <li>Warm-up</li>
  <li>Virtual machines</li>
  <li>Characteristics of cloud computing</li>
  <li>Cloud service models</li>
  <li>Review</li>
</ul>

<h2 id="warm-up">Warm-up</h2>
<ul>
  <li><em>Below is a simplified picture of Aaron’s home.</em></li>
</ul>

<p><img src="../images/wireless/home.png" style="width:450px;" /></p>

<ul>
  <li><em>Aaron’s wireless smart television with built-in video streaming does not work well: videos pause frequently to buffer, and videos have low resolution.</em></li>
  <li>Q1: <em>What are two potential causes of this problem?</em>
    <ul>
      <li>The television is too far from the wireless access point (AP)</li>
      <li>There is interference from the microwave oven and baby monitor</li>
      <li>The wireless network doesn’t have enough bandwidth</li>
    </ul>
  </li>
  <li>Q2: <em>What can Aaron change to address each of these problems?</em>
    <ul>
      <li>Move the television closer, add another AP, or switch the network to 2.4GHz</li>
      <li>Switch the network to 5GHz</li>
      <li>Switch the network to 5GHz</li>
    </ul>
  </li>
</ul>

<h2 id="virtual-machines-vms">Virtual machines (VMs)</h2>
<ul>
  <li>Recall: <em>what is the purpose of an OS?</em>
    <ul>
      <li>Make computer hardware easy to use—e.g., an OS knows how to load an application’s executable code from persistent storage (e.g., solid state drive (SSD)) into main memory, initialize the process’s address space (code, heap, stack), and make the CPU execute the application’s instructions</li>
      <li>Support multiprocessing—i.e., running multiple applications concurrently</li>
      <li>Allocate and manage hardware resources—e.g., decide when/which applications can use the CPU, decide when/which memory applications can use, prevent applications from stealing/accessing another application’s CPU time or memory</li>
    </ul>
  </li>
  <li>What is the purpose of a virtual machine?
    <ul>
      <li>Make computer hardware flexible to use</li>
      <li>Support multiple OSes running concurrently</li>
      <li>Allocate and manage hardware resources—e.g., decide when/which VMs can use the CPU, decide/when which memory VMs can use, prevent VMS from stealing/accessing another VM’s CPU time or memory</li>
    </ul>
  </li>
  <li>What is the motivation for using a virtual machine?
    <ul>
      <li>Run multiple OSes concurrently — <em>why would someone one to do this?</em>
        <ul>
          <li>Run software only supported by a specific OS</li>
          <li>Software testing</li>
          <li>Server consolidation</li>
          <li>Security sandboxing</li>
        </ul>
      </li>
      <li>Flexibly use hardware resources</li>
    </ul>
  </li>
</ul>

<h2 id="characteristics-of-cloud-computing">Characteristics of cloud computing</h2>
<ul>
  <li>Resources available on-demand — tenants reserve resources only when they need them
    <ul>
      <li>E.g., a company uses more virtual machines during the day when employees are using applications</li>
      <li>E.g., a website has more visitors during a sale or popular event</li>
    </ul>
  </li>
  <li>Pay-per-use — only pay for the resources you use
    <ul>
      <li>E.g., pay for a virtual machine per hour of use</li>
      <li>E.g., pay for storage per GB per month</li>
    </ul>
  </li>
  <li>Shared &amp; virtualized — physical servers and storage devices resources are used by multiple tenants
    <ul>
      <li>E.g., multiple virtual machines run on the same machine</li>
      <li>Physical servers and storage are usually more isolated than network switches and links</li>
    </ul>
  </li>
</ul>

<h2 id="cloud-service-models">Cloud service models</h2>
<ul>
  <li>Infrastructure-as-a-Service (IaaS)
    <ul>
      <li>Tenants lease virtual machines, virtual storage, and virtual networks</li>
      <li>Tenants must manage the operating system, file system, etc.</li>
      <li>E.g., Amazon EC2, Microsoft Azure, Rackspace, Google Compute Engine</li>
    </ul>
  </li>
  <li>Platform-as-a-Service (PaaS)
    <ul>
      <li>Tenants lease resources to run applications written in a specific language — Python, Java, Hadoop/MapReduce</li>
      <li>Cloud provider manages the operating system, file system, and network</li>
      <li>E.g., Google App Engine, Cloud Foundry, IBM Cloud</li>
    </ul>
  </li>
  <li>Function-as-a-Service (FaaS) or serverless
    <ul>
      <li>Tenants run independent snippets of code</li>
      <li>E.g., Amazon Lambda</li>
    </ul>
  </li>
  <li>Software-as-a-Service (SaaS)
    <ul>
      <li>Tenants lease access to specific software</li>
      <li>E.g., Salesforce, Concur, Constant Contact, Google Drive, Office 365</li>
    </ul>
  </li>
  <li>Storage-as-a-Service (STaaS)
    <ul>
      <li>E.g., Dropbox, Google Drive, iCloud</li>
    </ul>
  </li>
  <li>Ownership
    <ul>
      <li>Public - anyone can request and use resources</li>
      <li>Private - resources are only available to tenants (e.g., departments) within a company or organization</li>
      <li>Hybrid - tenants use a combination of public and private cloud resources</li>
    </ul>
  </li>
  <li>Q3: <em>For each of the following service providers, indicate what type of service they offer.</em>
    <ul>
      <li><em>Box provides secure file sharing and storage</em> — Storage-as-a-Service (STaaS)</li>
      <li><em>Microsoft Azure provides virtual machines running Windows or Linux</em> — Infrastructure-as-a-Service (IaaS)</li>
      <li><em>Heroku allows tenants to deploy code written in Ruby, Java, PHP, Python, Go, Scala, or Clojure</em> — Platform-as-a-Service (PaaS)</li>
      <li><em>Oracle Supply Chain Management (SCM) is software that allows businesses to manage their supply chain</em> — Software-as-a-Service (SaaS)</li>
    </ul>
  </li>
</ul>

<h2 id="review-memory">Review: memory</h2>
<ul>
  <li>The intended behavior of the program below is to output a string that contains multiple copies of a word (e.g., <code class="language-plaintext highlighter-rouge">"byebye"</code>). The code below compiles without warnings, but it contains multiple errors.
    <pre><code class="language-C">  1   #include &lt;stdlib.h&gt;
  2   #include &lt;string.h&gt;
  3   #include &lt;stdio.h&gt;
  4   char *repeat(char *word, int count) {
  5       char *dup = malloc(sizeof(*word) * count + 1);
  6       int k = 0;
  7       for (int i = 0; i &lt; count; i++) {
  8           for (int j = 0; j &lt;= strlen(word) * count; j++) {
  9               dup[k] = word[j];
  10              k++;
  11          }
  12      }
  13      free(dup);
  14      return dup;
  15  }
  16  int main() {
  17      char *orig = malloc(4);
  18      strcpy(orig, "bye");
  19      char *result = repeat(orig, 2);
  20      printf("%s\n", result);
  21  }
</code></pre>
    <p>For each of the following errors produced by valgrind, describe (in 2-3 sentences) <strong>why</strong> the error is occurring and <strong>how</strong> you would modify the code to correct the error.</p>

    <ul>
      <li>Q4:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Invalid write of size 1
      at 0x4006CA: repeat (repeat.c:9)
      by 0x400752: main (repeat.c:19)
  Address 0x5204093 is 0 bytes after a block of size 3 alloc'd
      at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
      by 0x40066B: repeat (repeat.c:5)
      by 0x400752: main (repeat.c:19)
</code></pre></div>        </div>
        <p>Not enough space was allocated for the duplicated string: <code class="language-plaintext highlighter-rouge">sizeof(*word)</code> gets the size of a single character. Use <code class="language-plaintext highlighter-rouge">strlen(word)</code> to get the number of characters in the original word.</p>
      </li>
      <li>Q5:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Invalid read of size 1
      at 0x4006BF: repeat (repeat.c:9)
      by 0x400752: main (repeat.c:19)
  Address 0x5204044 is 0 bytes after a block of size 4 alloc'd
      at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
      by 0x400723: main (repeat.c:17)
</code></pre></div>        </div>
        <p>The inner for loop goes beyond the end of the original word. The for loop condition should be <code class="language-plaintext highlighter-rouge">j &lt; strlen(word)</code>.</p>
      </li>
      <li>Q6:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Invalid read of size 1
      at 0x4E88CD0: vfprintf (vfprintf.c:1632)
      by 0x4E8F8A8: printf (printf.c:33)
      by 0x40076B: main (repeat.c:20)
  Address 0x5204090 is 0 bytes inside a block of size 3 free'd
      at 0x4C2EDEB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
      by 0x4006FF: repeat (repeat.c:13)
      by 0x400752: main (repeat.c:19)
  Block was alloc'd at
      at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
      by 0x40066B: repeat (repeat.c:5)
      by 0x400752: main (repeat.c:19)
</code></pre></div>        </div>
        <p>The string containing the repeated word is free’d (in <code class="language-plaintext highlighter-rouge">repeat</code>) before it is printed (in <code class="language-plaintext highlighter-rouge">main</code>). Move the call to <code class="language-plaintext highlighter-rouge">free</code> in <code class="language-plaintext highlighter-rouge">repeat</code> to after the call to <code class="language-plaintext highlighter-rouge">printf</code> in <code class="language-plaintext highlighter-rouge">main</code>.</p>
      </li>
      <li>Q7:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  4 bytes in 1 blocks are definitely lost in loss record 1 of 1
      at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
      by 0x400723: main (repeat.c:17)
</code></pre></div>        </div>
        <p>The space for the original word (allocated in <code class="language-plaintext highlighter-rouge">main</code>) is not freed. Add <code class="language-plaintext highlighter-rouge">free(orig)</code> after the call to <code class="language-plaintext highlighter-rouge">repeat</code> in <code class="language-plaintext highlighter-rouge">main</code>.</p>
      </li>
    </ul>
  </li>
</ul>

<h2 id="review-threads">Review: threads</h2>
<ul>
  <li>A program contains the following global variables and functions:
    <pre><code class="language-C">  void *dbl(void *arg) {
      int *t = (int *)arg;
      *t = *t * 2;
  }

  void *one(void *arg) {
      int *t = (int *)arg;
      *t = 1;
  }
</code></pre>
    <p><em>For each of the following main methods, list <strong>all possible outputs</strong> the program could produce. Assume threads are only preempted if they become blocked waiting for other threads.</em></p>
    <ul>
      <li>Q8:
        <pre><code class="language-C">  int main() {
      int *total = malloc(sizeof(int));
      *total = 3;
      pthread_t thrA, thrB;
      pthread_create(&amp;thrA, NULL, &amp;dbl, total);
      pthread_create(&amp;thrB, NULL, &amp;one, total);
      pthread_join(&amp;thrA);
      pthread_join(&amp;thrB);
      printf("%d\n", total);
  }
</code></pre>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">1</code> (if <code class="language-plaintext highlighter-rouge">thrB</code> runs after <code class="language-plaintext highlighter-rouge">thrA</code> finishes)</li>
          <li><code class="language-plaintext highlighter-rouge">2</code> (if <code class="language-plaintext highlighter-rouge">thrA</code> runs after <code class="language-plaintext highlighter-rouge">thrB</code> finishes)</li>
        </ul>
      </li>
      <li>Q9:
        <pre><code class="language-C">  int main() {
      int *total = malloc(sizeof(int));
      *total = 3
      pthread_t thrA, thrB;
      pthread_create(&amp;thrA, NULL, &amp;one, total);
      pthread_join(&amp;thrA);
      pthread_create(&amp;thrB, NULL, &amp;dbl, total);
      pthread_join(&amp;thrB);
      printf("%d\n", total);
  }
</code></pre>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">2</code> (<code class="language-plaintext highlighter-rouge">thrA</code> is joined, i.e., must finish, before <code class="language-plaintext highlighter-rouge">thrB</code> is created)</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="review-sockets">Review: sockets</h2>
<ul>
  <li>Q10: <em>What sequence of socket functions should a server application call?</em>
    <ol>
      <li><code class="language-plaintext highlighter-rouge">socket</code></li>
      <li><code class="language-plaintext highlighter-rouge">bind</code></li>
      <li><code class="language-plaintext highlighter-rouge">listen</code></li>
      <li><code class="language-plaintext highlighter-rouge">accept</code></li>
      <li><code class="language-plaintext highlighter-rouge">recv</code></li>
      <li><code class="language-plaintext highlighter-rouge">send</code></li>
      <li><code class="language-plaintext highlighter-rouge">close</code></li>
      <li><code class="language-plaintext highlighter-rouge">close</code></li>
    </ol>
  </li>
</ul>

  </body>
</html>