# Program memory: 2D arrays
_COSC 208, Introduction to Computer Systems, 2023-02-27_

## Announcements
* Programming project 2 due Thursday @ 11pm
* Professor candidate talks this week:
    * Tues 11:30am-12pm, McGregory 319: ‚ÄúWave Function Collapse (not the physics one)‚Äù, David Perkins
    * Thurs 11:30am-12:30pm, McGregory 319: ‚ÄúWhat neural models tell us about linguistic knowledge: insights from cross-linguistic investigations‚Äù, Forrest Davis

## Outline
* Warm-up
* 2D arrays on the stack
* 2D arrays a linear arrays
* 2D arrays as array-of-arrays
* Command-line arguments

## Warm-up
* Q1: _Assume you wanted to write a function that creates a copy of a string. What is wrong with each of the following attempts at writing such a function?_


```c
#include <string.h>
char *copy1(char strA[]) {
    char strB[strlen(strA) + 1];
    strcpy(strB, strA);
    return strB;
}
```

<p style="height:2em;"></p>


```c
#include <string.h>
#include <stdlib.h>
char copy2(char strA[]) {
    char *strB = malloc(sizeof(char) * (strlen(strA) + 1));
    strcpy(strB, strA);
    return *strB;
}
```

<p style="height:2em;"></p>


```c
#include <string.h>
#include <stdlib.h>
char *copy3(char strA[]) {
    char *strB = malloc(sizeof(char *));
    strcpy(strB, strA);
    return strB;
}
```

<p style="height:2em;"></p>

üõë **STOP here** after completing the above question; if you have extra time take a few deep breaths to reduce stress.

<div style="page-break-after:always;"></div>

## 2D arrays on the stack
* Assume we wanted to create an array to represent a calendar:
    ```
    +----+----+----+----+----+----+----+
    |  1 |  2 |  3 |  4 |  5 |  6 |  7 |
    +----+----+----+----+----+----+----+
    |  8 |  9 | 10 | 11 | 12 | 13 | 14 |
    +----+----+----+----+----+----+----+
    | 15 | 16 | 17 | 18 | 19 | 20 | 21 |
    +----+----+----+----+----+----+----+
    | 22 | 23 | 24 | 25 | 26 | 27 | 28 |
    +----+----+----+----+----+----+----+
    ```
    * 4 rows = 4 weeks; 7 columns = 7 days in a week
* Q2: _Write a function called `fill_calendar` that creates a 2D array on the stack and populates the array with the appropriate values._


<p style="height:25em;"></p>

üõë **STOP here** after completing the above question; if you have extra time take a few deep breaths to reduce stress.

## 2D arrays as linear arrays

* Q3: _Fill-in the blanks to complete the `fill_calendar_linear` function which creates a fully linear calendar._
    ```C
    void fill_calendar_linear() {
        int calendar[_____];
        int day = 1;
        for (int week = 0; week < 4; week++) {
            for (int dow = 0; dow < 7; dow++) {
                calendar[__________________] = day;
                day++;
            }
        }
    }
    ```

üõë **STOP here** after completing the above question; if you have extra time take a few deep breaths to reduce stress.

<div style="page-break-after:always;"></div>

## 2D arrays as array-of-arrays

* Example


```c
#include <stdlib.h>
int **fill_calendar_arrayofarrays_heap() {
    int **calendar = malloc(sizeof(int *) * 4);
    int day = 1;
    for (int week = 0; week < 4; week++) {
        calendar[week] = malloc(sizeof(int) * 7);
        for (int dow = 0; dow < 7; dow++) {
            calendar[week][dow] = day;
            day++;
        }
    }
    return calendar;
}
```

<div style="page-break-after:always;"></div>

* Q4: _Draw a memory diagram depicting the contents of the stack and heap immediately before the function `elongate("dog")` returns._


```c
#include <string.h>
#include <stdlib.h>
char **elongate(char *str) {
    char **result = malloc(sizeof(char *) * strlen(str));
    for (int i = 0; i < strlen(str); i++) {
        result[i] = malloc(sizeof(char) * (i + 2));
        for (int j = 0; j < i+1; j++) {
            result[i][j] = str[j];
        }
        result[i][i+1] = '\0';
    }
    return result;
}
int main() {
    elongate("dog");
}
```

<p style="height:30em;"></p>

üõë **STOP here** after completing the above question; if you have extra time take a few deep breaths to reduce stress.

## Command-line arguments

* Example


```c
#include <stdio.h>
int main(int argc, char *argv[]) {
    for (int i = 0; i < argc; i++) {
        printf("%s\n", argv[i]);
    }
}
```
